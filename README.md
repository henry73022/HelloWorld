# HelloWorld
select ROW_NUMBER() OVER(ORDER BY X.Dispatch_No) AS ROWID,case X.Category when 'D' then '拆機' when 'C' then '併機' when 'M' then '異動' when 'T' then '原機延用' when 'O' then '其他' when 'I' then '裝機' ELSE '' END,X.Dispatch_No,X.Terminal_Id,X.Merch_Id,Z.MM_BIZ_NAME,convert(varchar(8),X.C_Date,112),X.Memo  from (  select C.Dispatch_No, C.Dispatch_Date, C.Category, C.Status, C.Expected_Date, C.Complete_Date, C.Memo, C.C_Date, A.Merch_Id, A.Terminal_Id, A.Vendor_No, dbo.fun_TerminalPropertyNo_Combine(A.Terminal_Id) as Property_No, A.Fitting_Flg1, A.Fitting_Property1, A.Fitting_Flg2, A.Fitting_Property2, A.Fitting_Flg3, A.Fitting_Property3, A.Fitting_Flg4, A.Fitting_Property4, A.Fitting_Flg5, A.Fitting_Property5, C.OldTerminal_Id   from tbl_FISC_M_Terminal A left JOIN tbl_FISC_M_Dispatch_Terminal B on A.Terminal_Id = B.Terminal_Id left JOIN tbl_FISC_M_Dispatch C on B.Dispatch_No = C.Dispatch_No   ) X, [FISCDB].[dbo].[tbl_FISC_C_ParaCode] Y , tbl_FISC_R_MERMST_BusinessData Z  WHERE Y.ctype = '002' and Y.CSUB = X.Vendor_No and (X.Status = '1' or X.Status = '2' ) and '201707270930' > replace(replace(replace(convert(char(16),DATEADD(hour,Y.dispatch_Notice_Final,X.C_Date),120),' ',''),'-',''),':','') and Z.MM_MERCHANT_NO = X.Merch_Id  order by X.Terminal_Id
